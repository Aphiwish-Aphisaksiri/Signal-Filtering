% Load the ECG signal from the .mat file
load('noisyecg/noisyecg.mat');

% Compute the power spectral density using pwelch
fs = 500; % Sampling frequency (Hz)
window = hamming(1024); % Window function
noverlap = 512; % Number of samples to overlap
nfft = 1024; % Number of FFT points
[Pxx_original, f] = pwelch(ecg1, window, noverlap, nfft, fs);

b = [1.09030322493878e-06,-4.45647866853248e-07,6.51042406642505e-07,-8.88755535867994e-07,2.30198739305666e-07,-1.24404804631488e-06,-2.25307775162471e-08,-1.38506952063310e-06,-7.90357734989728e-08,-1.41481039587840e-06,-1.23993785909019e-06,-1.13310440955226e-06,-1.07359567588474e-06,-1.04420557135966e-06,-1.02650855731013e-06,-1.01158032112720e-06,-9.94019424177165e-07,-9.79421254444290e-07,-9.73366429130175e-07,-9.85712519028559e-07,-1.01758272978856e-06,-1.06851028036952e-06,-1.12705313842206e-06,-1.18417030625469e-06,-1.22684474988339e-06,-1.25358406109779e-06,-1.26397496927986e-06,-1.27092444129672e-06,-1.28231228275895e-06,-1.31229381364400e-06,-1.35916072791579e-06,-1.42686784822009e-06,-1.49058678846954e-06,-1.55219698720026e-06,-1.58629856067781e-06,-1.60678696865896e-06,-1.60168700288672e-06,-1.60424520772366e-06,-1.60798751429225e-06,-1.63982309937527e-06,-1.68674548633719e-06,-1.75061333144913e-06,-1.81234666826524e-06,-1.85872208462017e-06,-1.87948828955186e-06,-1.87385088925722e-06,-1.85529156279024e-06,-1.83288547919691e-06,-1.82985494336375e-06,-1.84958705817055e-06,-1.89345806035780e-06,-1.94599509280086e-06,-1.99292866519810e-06,-2.01548098950422e-06,-2.00788625325716e-06,-1.97148036347520e-06,-1.92213872892747e-06,-1.87730130146600e-06,-1.85478835946309e-06,-1.86045576397302e-06,-1.88952571828411e-06,-1.92502557357469e-06,-1.94537943469302e-06,-1.93541493477514e-06,-1.88771664399979e-06,-1.81156018066261e-06,-1.72455278100303e-06,-1.64989598776957e-06,-1.60328899986561e-06,-1.58957155748845e-06,-1.59720093931877e-06,-1.60573141042058e-06,-1.59160089706915e-06,-1.53734155546832e-06,-1.44245241543743e-06,-1.31760136696611e-06,-1.18949173243545e-06,-1.07991242302359e-06,-1.00741612948550e-06,-9.68654740155675e-07,-9.51301595336331e-07,-9.25077580803970e-07,-8.68603271746762e-07,-7.62505273478135e-07,-6.13079994372247e-07,-4.36669632402865e-07,-2.64248721445510e-07,-1.20165018118960e-07,-2.06953265392935e-08,4.14264046777431e-08,8.70002376588439e-08,1.49146374157151e-07,2.53677192717169e-07,4.13749899641781e-07,6.20171955250493e-07,8.47722681240566e-07,1.06143722053043e-06,1.23478708610084e-06,1.35587033530960e-06,1.43809959024994e-06,1.50941386791959e-06,1.60759059836098e-06,1.75837645366509e-06,1.97224573224179e-06,2.23082241789780e-06,2.50291197142305e-06,2.74777016205892e-06,2.93973076108678e-06,3.07109166497476e-06,3.16390229207220e-06,3.25268793650747e-06,3.38103740788586e-06,3.57267197865136e-06,3.83284405674091e-06,4.13415134058172e-06,4.43797735244864e-06,4.69823983327670e-06,4.89169337582997e-06,5.01651794928026e-06,5.10416444328203e-06,5.19810614443377e-06,5.34423910584550e-06,5.56555316340396e-06,5.85810579841829e-06,6.18591414543108e-06,6.50011647376853e-06,6.75310107925686e-06,6.92332290284269e-06,7.01850933531022e-06,7.08014834329135e-06,7.16029680605591e-06,7.30806128530060e-06,7.54177438793360e-06,7.84853991286474e-06,8.17983028734543e-06,8.47918957366864e-06,8.69565812220683e-06,8.81312877506970e-06,8.84986423773388e-06,8.85955135856428e-06,8.90303166612393e-06,9.03115429970874e-06,9.25614477974137e-06,9.55310276996420e-06,9.86070464151690e-06,1.01135495280426e-05,1.02591073972572e-05,1.02891209237682e-05,1.02344102787729e-05,1.01628460186402e-05,1.01441787498025e-05,1.02299024555723e-05,1.04236715314249e-05,1.06858048257197e-05,1.09410427331862e-05,1.11133927669641e-05,1.11519494947885e-05,1.10569048806960e-05,1.08760569043027e-05,1.06926248296077e-05,1.05862034654689e-05,1.06070683367225e-05,1.07479616240370e-05,1.09516478376925e-05,1.11250841193940e-05,1.11833069006504e-05,1.10763532870228e-05,1.08178930197257e-05,1.04750760715251e-05,1.01497309867163e-05,9.93210596071149e-06,9.87000543713143e-06,9.94163961269143e-06,1.00677281731932e-05,1.01351906972777e-05,1.00476472229096e-05,9.75843757607213e-06,9.29818191069884e-06,8.75846121511265e-06,8.26442831786306e-06,7.91830122035294e-06,7.76440525659535e-06,7.76145854395064e-06,7.80252360991575e-06,7.74867956068150e-06,7.48936488343886e-06,6.98314394461436e-06,6.28236945471913e-06,5.51146971139146e-06,4.82513634503180e-06,4.34258774065802e-06,4.10241567165968e-06,4.03825751496815e-06,4.00514978738843e-06,3.82859933348851e-06,3.37899020360113e-06,2.62016358730856e-06,1.63500123203409e-06,5.93301462771541e-07,-3.06569390770046e-07,-9.20816818398330e-07,-1.21634171080104e-06,-1.29560192266109e-06,-1.35902914228005e-06,-1.63545803289692e-06,-2.28687245742408e-06,-3.34383627157629e-06,-4.67898190515983e-06,-6.05233070166531e-06,-7.19423786711686e-06,-7.91698640280472e-06,-8.19086045698903e-06,-8.17408591929077e-06,-8.15860517801846e-06,-8.46938245069528e-06,-9.33099367352704e-06,-1.07735603832171e-05,-1.25977458702766e-05,-1.44379066765296e-05,-1.58881300509108e-05,-1.66656901676772e-05,-1.67335728943189e-05,-1.63460666143609e-05,-1.59753789465619e-05,-1.61510207208331e-05,-1.72495170632677e-05,-1.93266520322079e-05,-2.20477819878884e-05,-2.47718325901960e-05,-2.67606042850374e-05,-2.74658277405811e-05,-2.67773864991395e-05,-2.51473268929671e-05,-2.35048536142446e-05,-2.29763170840471e-05,-2.44649439921016e-05,-2.82404753562866e-05,-3.36759888534014e-05,-3.92795091073425e-05,-4.30552821641037e-05,-4.31634504238568e-05,-3.87042273365296e-05,-3.04220800359375e-05,-2.10755247674490e-05,-1.53156060396231e-05,-1.89968155165496e-05,-3.80323283066610e-05,-7.70068032478847e-05,-0.000137889301323778,-0.000219161076072545,-0.000315633951283426,-0.000419047457590954,-0.000519381824211630,-0.000606612941076069,-0.000672549497692791,-0.000712333014789981,-0.000725279333378523,-0.000714868409795947,-0.000687909750137305,-0.000653078765504513,-0.000619180128236000,-0.000593519856094373,-0.000580744583139904,-0.000582351248359171,-0.000596924130051859,-0.000620951226248469,-0.000649979068157041,-0.000679776220249113,-0.000707244172548096,-0.000730875687777362,-0.000750734744114431,-0.000768025982774017,-0.000784454148487931,-0.000801568123345617,-0.000820292250446461,-0.000840732483579686,-0.000862283221197196,-0.000883935918128169,-0.000904675648140088,-0.000923809950215562,-0.000941148151952842,-0.000956977242216439,-0.000971886122272775,-0.000986500591785223,-0.00100124602206741,-0.00101620126911081,-0.00103109670979846,-0.00104542984421823,-0.00105865614434959,-0.00107037008937252,-0.00108042309557548,-0.00108893348086960,-0.00109620370354336,-0.00110257331836368,-0.00110827777189194,-0.00111334973238359,-0.00111761126749534,-0.00112073500989480,-0.00112236531917121,-0.00112223078848486,-0.00258979169461088,-0.000365639198903564,-0.00190756448630252,0.000259763176208090,-0.00137173181065073,0.000653717697914115,-0.00115730522188929,0.000693153231023670,-0.00123858131576648,0.000581831803218743,0.000185008035380849,-8.45347897195607e-05,-0.000264753392485579,-0.000387394628526163,-0.000481103242799488,-0.000560892989677799,-0.000633492244464543,-0.000692185835329446,-0.000728769252996249,-0.000732565934895311,-0.000703465229532271,-0.000646434426063718,-0.000578152359620605,-0.000513497242154499,-0.000467989148523452,-0.000443293749275571,-0.000435400915759753,-0.000426679450603954,-0.000403116280426525,-0.000349409715175039,-0.000267207510721040,-0.000162014939808756,-5.56609709456090e-05,3.88118427070090e-05,0.000103069154216144,0.000145647223971916,0.000165576275379195,0.000198489987543234,0.000245693084631849,0.000332263219658061,0.000446451573377325,0.000583990788915138,0.000714847906048613,0.000825757107046680,0.000901545830840731,0.000947563457152449,0.000983137336597222,0.00102405672602925,0.00109996282034672,0.00121383402495463,0.00136264661762206,0.00152313745571390,0.00167372305392919,0.00179076019690679,0.00186902083339600,0.00191505087620853,0.00195338803358087,0.00200925894877865,0.00210516210501834,0.00224514057322652,0.00241832018595282,0.00259773545741185,0.00275541569470283,0.00286973559749453,0.00293795500286936,0.00297481858581259,0.00300940156887374,0.00307194319591910,0.00318225783191720,0.00334144512605737,0.00352944169798440,0.00371543657496503,0.00386558722991561,0.00396234581365864,0.00400717799360440,0.00402216161370653,0.00404432830731803,0.00410445410972293,0.00422207636786845,0.00438830617924437,0.00457967832962042,0.00475343296282630,0.00488043176618746,0.00493974629436557,0.00494510741649864,0.00492492954122684,0.00492256907516881,0.00497003084453656,0.00508315669582792,0.00524572041197605,0.00542320108558036,0.00556907266900622,0.00565040883122233,0.00565472513160715,0.00560213004722377,0.00553172121402452,0.00549218920681588,0.00551636427459331,0.00561285788826806,0.00575637665669986,0.00590230390596469,0.00599921197524168,0.00601438141316222,0.00594310920680357,0.00581561785925629,0.00568153180755322,0.00559417349230870,0.00558480377175749,0.00565361582187923,0.00576336320441006,0.00586043696222630,0.00588699331252653,0.00581531781683629,0.00564823956795586,0.00543032418262416,0.00521948083682065,0.00507558030994530,0.00502373497588399,0.00505500867400673,0.00511815645265467,0.00514862015102356,0.00508686677080402,0.00490859346831856,0.00463019839508198,0.00430908511074229,0.00401535381331225,0.00380930196516732,0.00371136270612919,0.00369790054384687,0.00370400416905893,0.00365400256912019,0.00348672762925656,0.00318596168222072,0.00278317573545499,0.00235125134686258,0.00197093747912863,0.00170346931011047,0.00155997877521333,0.00150051302400060,0.00144363295856745,0.00130350032757362,0.00101903086214578,0.000585404284466975,5.13542685783264e-05,-0.000491931630650384,-0.000954369451314687,-0.00127477949504216,-0.00145604079054907,-0.00155638094005340,-0.00167643063416533,-0.00191157773268608,-0.00232072221722705,-0.00289379340696470,-0.00356052089788928,-0.00421091390704033,-0.00474329348473620,-0.00510189548399835,-0.00530417220748827,-0.00543311277387004,-0.00560911375584511,-0.00593851092465089,-0.00647402905822845,-0.00718775843467333,-0.00798322476756879,-0.00872808137524991,-0.00931048239456436,-0.00968092226471880,-0.00987838814928411,-0.0100136644883343,-0.0102312929110101,-0.0106480110288320,-0.0113087369469937,-0.0121612065058249,-0.0130777354946999,-0.0138993545509016,-0.0145034517683929,-0.0148495862396651,-0.0150044173103014,-0.0151133250983409,-0.0153507212867125,-0.0158445872472127,-0.0166290851832553,-0.0176203022251108,-0.0186509448332401,-0.0195287646369444,-0.0201173265446806,-0.0203897989122784,-0.0204478782917441,-0.0204836983981347,-0.0207089759221027,-0.0212686663411823,-0.0221804917939626,-0.0233201302721185,-0.0244655305662367,-0.0253792822034161,-0.0259057123158745,-0.0260350543365385,-0.0259179961041236,-0.0258111999442438,-0.0259825488169372,-0.0265991061969092,-0.0276641214968441,-0.0289884508295034,-0.0302761756373023,-0.0312139855765855,-0.0316189094709099,-0.0314973859240960,-0.0310784512729140,-0.0307139736614049,-0.0307690603347958,-0.0314545599076214,-0.0327469248356976,-0.0343697276831324,-0.0358896283930393,-0.0368734500515485,-0.0370660246674988,-0.0365046754036323,-0.0355339715360272,-0.0346930166964961,-0.0345196751781085,-0.0353325952997745,-0.0370809095683808,-0.0393241251225395,-0.0413659120165278,-0.0425038390542968,-0.0423117862618530,-0.0408462049768089,-0.0386879149065316,-0.0367796708302638,-0.0361002863044120,-0.0372731052511167,-0.0402595911068885,-0.0442600878525909,-0.0479027992558519,-0.0496868851194617,-0.0485652523845588,-0.0444622956220706,-0.0385309250712591,-0.0329889602295892,-0.0305139659640456,-0.0333003120270881,-0.0420342388060645,-0.0550914345164022,-0.0682669215837065,-0.0752138572760833,-0.0686079597493719,-0.0418261760227550,0.00922122016529245,0.0845758553513095,0.179450266936785,0.284469398133402,0.386970785323234,0.473151937440160,0.530621650749456,0.550799904207720,0.530621650749457,0.473151937440161,0.386970785323234,0.284469398133401,0.179450266936785,0.0845758553513095,0.00922122016529244,-0.0418261760227550,-0.0686079597493719,-0.0752138572760833,-0.0682669215837065,-0.0550914345164022,-0.0420342388060645,-0.0333003120270880,-0.0305139659640456,-0.0329889602295892,-0.0385309250712591,-0.0444622956220706,-0.0485652523845589,-0.0496868851194617,-0.0479027992558519,-0.0442600878525909,-0.0402595911068885,-0.0372731052511167,-0.0361002863044120,-0.0367796708302638,-0.0386879149065316,-0.0408462049768089,-0.0423117862618529,-0.0425038390542968,-0.0413659120165277,-0.0393241251225394,-0.0370809095683808,-0.0353325952997745,-0.0345196751781085,-0.0346930166964961,-0.0355339715360272,-0.0365046754036323,-0.0370660246674988,-0.0368734500515485,-0.0358896283930393,-0.0343697276831324,-0.0327469248356976,-0.0314545599076215,-0.0307690603347958,-0.0307139736614049,-0.0310784512729140,-0.0314973859240960,-0.0316189094709099,-0.0312139855765855,-0.0302761756373023,-0.0289884508295034,-0.0276641214968441,-0.0265991061969092,-0.0259825488169372,-0.0258111999442438,-0.0259179961041236,-0.0260350543365384,-0.0259057123158745,-0.0253792822034161,-0.0244655305662367,-0.0233201302721185,-0.0221804917939626,-0.0212686663411823,-0.0207089759221027,-0.0204836983981347,-0.0204478782917441,-0.0203897989122784,-0.0201173265446806,-0.0195287646369444,-0.0186509448332401,-0.0176203022251108,-0.0166290851832553,-0.0158445872472127,-0.0153507212867125,-0.0151133250983409,-0.0150044173103014,-0.0148495862396651,-0.0145034517683929,-0.0138993545509016,-0.0130777354946999,-0.0121612065058249,-0.0113087369469937,-0.0106480110288319,-0.0102312929110102,-0.0100136644883343,-0.00987838814928411,-0.00968092226471880,-0.00931048239456436,-0.00872808137524991,-0.00798322476756879,-0.00718775843467333,-0.00647402905822846,-0.00593851092465089,-0.00560911375584511,-0.00543311277387005,-0.00530417220748826,-0.00510189548399835,-0.00474329348473620,-0.00421091390704033,-0.00356052089788928,-0.00289379340696470,-0.00232072221722705,-0.00191157773268608,-0.00167643063416533,-0.00155638094005340,-0.00145604079054907,-0.00127477949504216,-0.000954369451314687,-0.000491931630650383,5.13542685783264e-05,0.000585404284466976,0.00101903086214578,0.00130350032757361,0.00144363295856745,0.00150051302400060,0.00155997877521333,0.00170346931011047,0.00197093747912863,0.00235125134686258,0.00278317573545499,0.00318596168222072,0.00348672762925657,0.00365400256912019,0.00370400416905893,0.00369790054384687,0.00371136270612919,0.00380930196516732,0.00401535381331225,0.00430908511074229,0.00463019839508199,0.00490859346831856,0.00508686677080402,0.00514862015102357,0.00511815645265467,0.00505500867400673,0.00502373497588399,0.00507558030994530,0.00521948083682064,0.00543032418262416,0.00564823956795586,0.00581531781683629,0.00588699331252654,0.00586043696222630,0.00576336320441007,0.00565361582187922,0.00558480377175749,0.00559417349230870,0.00568153180755322,0.00581561785925629,0.00594310920680357,0.00601438141316223,0.00599921197524167,0.00590230390596469,0.00575637665669986,0.00561285788826806,0.00551636427459331,0.00549218920681588,0.00553172121402452,0.00560213004722377,0.00565472513160714,0.00565040883122233,0.00556907266900622,0.00542320108558037,0.00524572041197605,0.00508315669582792,0.00497003084453655,0.00492256907516880,0.00492492954122684,0.00494510741649864,0.00493974629436557,0.00488043176618746,0.00475343296282630,0.00457967832962042,0.00438830617924436,0.00422207636786845,0.00410445410972293,0.00404432830731803,0.00402216161370653,0.00400717799360439,0.00396234581365863,0.00386558722991561,0.00371543657496503,0.00352944169798440,0.00334144512605737,0.00318225783191720,0.00307194319591910,0.00300940156887374,0.00297481858581259,0.00293795500286936,0.00286973559749453,0.00275541569470283,0.00259773545741185,0.00241832018595282,0.00224514057322652,0.00210516210501834,0.00200925894877865,0.00195338803358087,0.00191505087620853,0.00186902083339600,0.00179076019690679,0.00167372305392919,0.00152313745571390,0.00136264661762206,0.00121383402495464,0.00109996282034672,0.00102405672602925,0.000983137336597222,0.000947563457152449,0.000901545830840732,0.000825757107046680,0.000714847906048612,0.000583990788915138,0.000446451573377325,0.000332263219658061,0.000245693084631849,0.000198489987543234,0.000165576275379195,0.000145647223971916,0.000103069154216144,3.88118427070090e-05,-5.56609709456090e-05,-0.000162014939808756,-0.000267207510721041,-0.000349409715175039,-0.000403116280426525,-0.000426679450603954,-0.000435400915759753,-0.000443293749275571,-0.000467989148523452,-0.000513497242154499,-0.000578152359620604,-0.000646434426063717,-0.000703465229532272,-0.000732565934895310,-0.000728769252996249,-0.000692185835329446,-0.000633492244464543,-0.000560892989677799,-0.000481103242799488,-0.000387394628526162,-0.000264753392485579,-8.45347897195613e-05,0.000185008035380849,0.000581831803218743,-0.00123858131576648,0.000693153231023671,-0.00115730522188929,0.000653717697914116,-0.00137173181065073,0.000259763176208091,-0.00190756448630252,-0.000365639198903564,-0.00258979169461088,-0.00112223078848486,-0.00112236531917121,-0.00112073500989480,-0.00111761126749534,-0.00111334973238359,-0.00110827777189194,-0.00110257331836368,-0.00109620370354336,-0.00108893348086960,-0.00108042309557548,-0.00107037008937252,-0.00105865614434959,-0.00104542984421823,-0.00103109670979846,-0.00101620126911081,-0.00100124602206741,-0.000986500591785223,-0.000971886122272775,-0.000956977242216439,-0.000941148151952842,-0.000923809950215562,-0.000904675648140088,-0.000883935918128168,-0.000862283221197196,-0.000840732483579687,-0.000820292250446461,-0.000801568123345618,-0.000784454148487931,-0.000768025982774018,-0.000750734744114431,-0.000730875687777362,-0.000707244172548097,-0.000679776220249113,-0.000649979068157041,-0.000620951226248469,-0.000596924130051859,-0.000582351248359171,-0.000580744583139904,-0.000593519856094373,-0.000619180128236001,-0.000653078765504513,-0.000687909750137305,-0.000714868409795947,-0.000725279333378523,-0.000712333014789980,-0.000672549497692790,-0.000606612941076069,-0.000519381824211630,-0.000419047457590954,-0.000315633951283426,-0.000219161076072545,-0.000137889301323778,-7.70068032478847e-05,-3.80323283066610e-05,-1.89968155165496e-05,-1.53156060396231e-05,-2.10755247674490e-05,-3.04220800359375e-05,-3.87042273365296e-05,-4.31634504238568e-05,-4.30552821641037e-05,-3.92795091073425e-05,-3.36759888534014e-05,-2.82404753562866e-05,-2.44649439921015e-05,-2.29763170840471e-05,-2.35048536142446e-05,-2.51473268929671e-05,-2.67773864991395e-05,-2.74658277405811e-05,-2.67606042850374e-05,-2.47718325901960e-05,-2.20477819878884e-05,-1.93266520322079e-05,-1.72495170632677e-05,-1.61510207208330e-05,-1.59753789465619e-05,-1.63460666143609e-05,-1.67335728943189e-05,-1.66656901676772e-05,-1.58881300509108e-05,-1.44379066765296e-05,-1.25977458702765e-05,-1.07735603832171e-05,-9.33099367352704e-06,-8.46938245069527e-06,-8.15860517801846e-06,-8.17408591929076e-06,-8.19086045698903e-06,-7.91698640280471e-06,-7.19423786711686e-06,-6.05233070166531e-06,-4.67898190515983e-06,-3.34383627157628e-06,-2.28687245742408e-06,-1.63545803289691e-06,-1.35902914228005e-06,-1.29560192266109e-06,-1.21634171080105e-06,-9.20816818398332e-07,-3.06569390770047e-07,5.93301462771540e-07,1.63500123203409e-06,2.62016358730856e-06,3.37899020360113e-06,3.82859933348851e-06,4.00514978738843e-06,4.03825751496815e-06,4.10241567165968e-06,4.34258774065802e-06,4.82513634503180e-06,5.51146971139146e-06,6.28236945471913e-06,6.98314394461436e-06,7.48936488343887e-06,7.74867956068149e-06,7.80252360991575e-06,7.76145854395063e-06,7.76440525659535e-06,7.91830122035294e-06,8.26442831786306e-06,8.75846121511264e-06,9.29818191069884e-06,9.75843757607213e-06,1.00476472229096e-05,1.01351906972777e-05,1.00677281731932e-05,9.94163961269143e-06,9.87000543713143e-06,9.93210596071148e-06,1.01497309867163e-05,1.04750760715251e-05,1.08178930197257e-05,1.10763532870228e-05,1.11833069006504e-05,1.11250841193940e-05,1.09516478376925e-05,1.07479616240370e-05,1.06070683367225e-05,1.05862034654689e-05,1.06926248296077e-05,1.08760569043027e-05,1.10569048806960e-05,1.11519494947885e-05,1.11133927669641e-05,1.09410427331862e-05,1.06858048257197e-05,1.04236715314249e-05,1.02299024555723e-05,1.01441787498025e-05,1.01628460186402e-05,1.02344102787729e-05,1.02891209237682e-05,1.02591073972572e-05,1.01135495280426e-05,9.86070464151690e-06,9.55310276996420e-06,9.25614477974137e-06,9.03115429970874e-06,8.90303166612392e-06,8.85955135856428e-06,8.84986423773388e-06,8.81312877506970e-06,8.69565812220683e-06,8.47918957366864e-06,8.17983028734543e-06,7.84853991286474e-06,7.54177438793361e-06,7.30806128530060e-06,7.16029680605590e-06,7.08014834329135e-06,7.01850933531022e-06,6.92332290284269e-06,6.75310107925686e-06,6.50011647376853e-06,6.18591414543108e-06,5.85810579841829e-06,5.56555316340396e-06,5.34423910584549e-06,5.19810614443377e-06,5.10416444328203e-06,5.01651794928026e-06,4.89169337582997e-06,4.69823983327670e-06,4.43797735244863e-06,4.13415134058172e-06,3.83284405674091e-06,3.57267197865136e-06,3.38103740788586e-06,3.25268793650747e-06,3.16390229207220e-06,3.07109166497476e-06,2.93973076108678e-06,2.74777016205892e-06,2.50291197142305e-06,2.23082241789780e-06,1.97224573224179e-06,1.75837645366509e-06,1.60759059836097e-06,1.50941386791959e-06,1.43809959024994e-06,1.35587033530960e-06,1.23478708610084e-06,1.06143722053043e-06,8.47722681240565e-07,6.20171955250493e-07,4.13749899641781e-07,2.53677192717169e-07,1.49146374157151e-07,8.70002376588439e-08,4.14264046777433e-08,-2.06953265392932e-08,-1.20165018118960e-07,-2.64248721445510e-07,-4.36669632402865e-07,-6.13079994372248e-07,-7.62505273478135e-07,-8.68603271746762e-07,-9.25077580803970e-07,-9.51301595336331e-07,-9.68654740155675e-07,-1.00741612948550e-06,-1.07991242302359e-06,-1.18949173243545e-06,-1.31760136696611e-06,-1.44245241543743e-06,-1.53734155546832e-06,-1.59160089706915e-06,-1.60573141042058e-06,-1.59720093931877e-06,-1.58957155748845e-06,-1.60328899986561e-06,-1.64989598776957e-06,-1.72455278100303e-06,-1.81156018066261e-06,-1.88771664399979e-06,-1.93541493477514e-06,-1.94537943469302e-06,-1.92502557357469e-06,-1.88952571828411e-06,-1.86045576397303e-06,-1.85478835946309e-06,-1.87730130146600e-06,-1.92213872892747e-06,-1.97148036347520e-06,-2.00788625325716e-06,-2.01548098950422e-06,-1.99292866519810e-06,-1.94599509280086e-06,-1.89345806035780e-06,-1.84958705817055e-06,-1.82985494336375e-06,-1.83288547919691e-06,-1.85529156279024e-06,-1.87385088925722e-06,-1.87948828955186e-06,-1.85872208462017e-06,-1.81234666826524e-06,-1.75061333144913e-06,-1.68674548633719e-06,-1.63982309937527e-06,-1.60798751429225e-06,-1.60424520772367e-06,-1.60168700288672e-06,-1.60678696865896e-06,-1.58629856067781e-06,-1.55219698720026e-06,-1.49058678846954e-06,-1.42686784822009e-06,-1.35916072791579e-06,-1.31229381364400e-06,-1.28231228275895e-06,-1.27092444129672e-06,-1.26397496927986e-06,-1.25358406109779e-06,-1.22684474988339e-06,-1.18417030625469e-06,-1.12705313842206e-06,-1.06851028036952e-06,-1.01758272978856e-06,-9.85712519028559e-07,-9.73366429130175e-07,-9.79421254444290e-07,-9.94019424177165e-07,-1.01158032112720e-06,-1.02650855731013e-06,-1.04420557135966e-06,-1.07359567588474e-06,-1.13310440955226e-06,-1.23993785909019e-06,-1.41481039587840e-06,-7.90357734989728e-08,-1.38506952063310e-06,-2.25307775162470e-08,-1.24404804631488e-06,2.30198739305666e-07,-8.88755535867993e-07,6.51042406642505e-07,-4.45647866853248e-07,1.09030322493878e-06];

% Normalize the filter coefficients
b = b / sum(b);

% Filter the signal with b
filtered_signal = filter(b, 1, ecg1);

% Compute the power spectral density of the filtered signal
[Pxx_filtered, f_filtered] = pwelch(filtered_signal, window, noverlap, nfft, fs);

% Plot the power spectral density of both signals
hold on;
plot(f, 10*log10(Pxx_original), 'b', 'LineWidth', 1.5);
plot(f_filtered, 10*log10(Pxx_filtered), 'r', 'LineWidth', 1.5);
hold off;

xlabel('Frequency (Hz)');
ylabel('Power Spectral Density (dB/Hz)');
title('Comparison of Power Spectral Density');
legend('Original Signal', 'Filtered Signal');
grid on;

% Plot the time domain comparison of the original and filtered signal
figure;

% Plot the original signal
subplot(2, 1, 1);
t = (0:length(ecg1)-1) / fs; % Time vector
plot(t, ecg1, 'b', 'LineWidth', 1.5);
xlabel('Time (s)');
ylabel('Amplitude');
title('Original Signal');
grid on;

% Plot the filtered signal
subplot(2, 1, 2);
plot(t, filtered_signal, 'r', 'LineWidth', 1.5);
xlabel('Time (s)');
ylabel('Amplitude');
title('Filtered Signal');
grid on;